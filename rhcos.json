{

"variables": {
  "vcenter_server": "vcsa.gxr.me",
  "vcenter_username": "administrator@vsphere.local",
  "vcenter_password": "",
  "vcenter_datacenter": "GXR",
  "vcenter_cluster": "GXR-Primary",
  "vcenter_host": "esx2.gxr.me",
  "vcenter_datastore_vm": "esx2_vms_nvme1",
  "vcenter_datastore_iso": "esx_WC_NFS",
  "vcenter_iso_path": "ISO/rhcos-4.3.8-x86_64-installer.x86_64.iso",
  "vcenter_folderpath": "",
  "vm_vcpu": "4",
  "vm_memory": "16384",
  "vm_disksize":"61440",
  "vm_network": "VM_vlan20",
  "vm_v4address": "192.168.20.71",
  "vm_v4defaultgw": "192.168.20.1",
  "vm_v4netmask": "255.255.255.0",
  "vm_v4dns_server": "192.168.1.1",
  "ocp_nodename": "bootstrap",
  "ocp_domainname": "gxr.me",
  "ocp_clustername": "test",
  "ocp_nodetype": "bootstrap",
  "ocp_url_image": "http://192.168.1.55:88/coreos/rhcos-4.3.8-x86_64-metal.x86_64.raw.gz",
  "ocp_url_ign": "http://192.168.1.55:88/ignition/{{user `ocp_clustername`}}/{{user `ocp_nodetype`}}.ign"
},

  "builders": [
    {
      "type": "vsphere-iso",
      "vcenter_server": "{{user `vcenter_server`}}",
      "username": "{{user `vcenter_username`}}",
      "password": "{{user `vcenter_password`}}",
      "host": "{{ user `vcenter_host`}}",
      "communicator": "ssh",
      "ssh_username": "core",
      "ssh_private_key_file": "~/.ssh/id_rsa",
      "shutdown_command": "sudo -S shutdown -P now",
      "insecure_connection": "true",
      "vm_name": "{{user `ocp_clustername` }}-{{user `ocp_nodename`}}",
      "folder": "{{user `vcenter_folderpath`}}",
      "cluster": "{{user `vcenter_cluster`}}",
      "datastore": "{{user `vcenter_datastore_vm`}}",
      "datacenter": "{{user `vcenter_datacenter`}}",
      "network": "{{user `vm_network`}}",
      "guest_os_type": "rhel7_64Guest",
      "CPUs": "{{user `vm_vcpu`}}",
      "RAM": "{{user `vm_memory`}}",
      "disk_controller_type": "pvscsi",
      "disk_size": "{{user `vm_disksize`}}",
      "disk_thin_provisioned": true,
      "vm_version": 13,
      "network_card": "vmxnet3",
      "iso_paths": [
        "[{{user `vcenter_datastore_iso` }}] {{user `vcenter_iso_path` }}"
      ],
      "boot_order": "disk,cdrom",
      "convert_to_template": false,
      "boot_wait": "10s",
      "boot_command": [
        "<tab>",
        " ip={{user `vm_v4address`}}::{{user `vm_v4defaultgw`}}:{{user `vm_v4netmask`}}:{{user `vm_nodename`}}.{{user `vm_domainname`}}:ens192:none nameserver={{user `vm_v4dns_server`}} coreos.inst.install_dev=sda coreos.inst.image_url={{user `ocp_url_image`}} coreos.inst.ignition_url={{user `ocp_url_ign`}}",
        "<wait>",
        "<enter>",
        "<wait>"
      ]
    }
  ]
}
